import{i as T,l as I,r as w,m as V,n as U,o,a as r,p as Y,t as z,f as i,b as d,q as F,j as e,d as c,v as H,c as b,w as q,x as A,y as O,e as v,F as W,u as G,s as K,h as _,_ as h,E as R}from"./index-CZcNuvIs.js";import{_ as M}from"./Tooltip.vue_vue_type_script_setup_true_lang-B7RLcYsW.js";const Q={class:"space-y-1.5"},X=["for"],Z=["placeholder","disabled","id","value","rows"],ee=T({__name:"Textarea",props:{size:{default:"sm"},variant:{default:"subtle"},placeholder:{},disabled:{type:Boolean},id:{},modelValue:{},debounce:{},rows:{default:3},label:{}},emits:["update:modelValue"],setup(k,{expose:m,emit:y}){const n=k,p=y,u=I(),L=w(null),S=V(()=>{let t={sm:"text-base rounded",md:"text-base rounded",lg:"text-lg rounded-md",xl:"text-xl rounded-md"}[n.size],g={sm:["py-1.5 px-2"],md:["py-1.5 px-2.5"],lg:["py-1.5 px-3"],xl:["py-1.5 px-3"]}[n.size],l=n.disabled?"disabled":n.variant,E={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",n.variant==="outline"?"border-gray-300":"border-transparent"]}[l];return[t,g,E,n.disabled?"text-gray-600":"text-gray-800","transition-colors w-full block"]}),a=V(()=>[{sm:"text-xs",md:"text-base",lg:"text-lg",xl:"text-xl"}[n.size],"text-gray-600"]);let C=t=>{p("update:modelValue",t)};n.debounce&&(C=U(C,n.debounce));let f=t=>{C(t.target.value)};return m({el:L}),(t,g)=>(o(),r("div",Q,[t.label?(o(),r("label",{key:0,class:Y(["block",a.value]),for:t.id},z(t.label),11,X)):i("",!0),d("textarea",F({ref_key:"textareaRef",ref:L,placeholder:t.placeholder,class:S.value,disabled:t.disabled,id:t.id,value:t.modelValue,rows:t.rows,onInput:g[0]||(g[0]=(...l)=>e(f)&&e(f)(...l)),onChange:g[1]||(g[1]=(...l)=>e(f)&&e(f)(...l))},e(u)),null,16,Z)]))}}),te={key:0},se={__name:"DaysList",props:["compStudId","myList"],setup(k){const m=k,y={date:{label:"Date",key:"date"},login_time:{label:"Login time",key:"login_time"},logout_time:{label:"Logout Time",key:"logout_time"}},n=Object.keys(JSON.parse(JSON.stringify(m.myList))[0]),p=JSON.parse(JSON.stringify(n)).map(u=>y[u]);return(u,L)=>(o(),r("div",null,[e(p)?(o(),r("div",te,[c(e(M),{class:"h-[200px]",columns:e(p),rows:k.myList,"row-key":"user",options:{selectable:!1,showTooltip:!1}},null,8,["columns","rows"])])):i("",!0)]))}},ae={key:0,class:"text-3xl"},le={key:1,class:"flex justify-center"},oe={class:"m-10 min-w-fit max-w-4xl w-3/4 h-3/4 min-h-fit border-gray-400 border-[2px] rounded p-5"},ne={class:"min-w-fit min-h-fit"},re={key:0,class:"text-3xl"},ie={key:1,class:"text-2xl"},de={key:2,class:"text-2xl"},ue={key:3,class:"text-2xl"},ge={key:4,class:"text-2xl"},ce={key:0,class:"text-xl"},me={key:1},fe={key:3,class:"min-w-fit min-h-fit"},ye={class:"p-2 flex flex-row justify-evenly min-w-fit min-h-fit"},pe={class:"flex flex-col"},be={key:4,class:"min-w-fit min-h-fit"},xe={class:"p-2 flex flex-row justify-evenly min-w-fit min-h-fit"},ve={class:"flex flex-col"},_e={class:"flex flex-col items-center min-w-fit min-h-fit"},he={class:"flex"},Le={__name:"Student",setup(k){const m=H({count:0,option:{penColor:"rgb(170, 170, 170)",backgroundColor:"rgb(35,35,35)"},disabled:!1}),y=w(""),n=w(null),p=()=>{n.value.clear()},u=new Date().toJSON().slice(0,10),L=G(),S=w(!1),a=w({dayExists:!1,nullLogin:!0,nullLogout:!0}),C=w(),f=b({url:"attend.api.roles.get_user_role",auto:!0});q(()=>{f.data==="Student"?L.push("/Student"):S.value=!0});const t=b({url:"frappe.auth.get_logged_user",auto:!0});t.promise.then(()=>{g.submit({student:t.data}),l.submit({student:t.data})});const g=b({url:"attend.api.fetchers.get_student_from_id"}),l=b({url:"attend.api.fetchers.get_student_days_list"}),E=b({url:"attend.api.actions.student_create_day"}),N=b({url:"attend.api.actions.student_login"}),B=b({url:"attend.api.actions.student_logout"});A(l,()=>{if(l.data!=null)for(var D=l.data.length,s=0;s<D;s++){const x=l.data[s];if(x.date==u){a.value.dayExists=!0,x.login_time!==null&&(a.value.nullLogin=!1),x.logout_time!==null&&(a.value.nullLogout=!1),C.value=x;break}}});const $=()=>{N.submit({student:t.data,date:u,time:new Date().toLocaleTimeString("en-US",{hour12:!1}),signature:n.value.save()}),N.promise.then(()=>{l.submit({student:t.data})})},j=()=>{B.submit({student:t.data,date:u,time:new Date().toLocaleTimeString("en-US",{hour12:!1}),signature:n.value.save(),journal_entry:y.value}),B.promise.then(()=>{l.submit({student:t.data})})},J=()=>{E.submit({student:t.data,date:u}),window.location.reload(),console.log("Creating new day entry!")},P=()=>{K.logout.submit(),window.location.reload()};return(D,s)=>(o(),r(W,null,[e(f).loading||e(t).loading||e(l).loading?(o(),r("h1",ae,"Hang on a moment...")):i("",!0),!e(f).loading&&!e(t).loading&&!e(l).loading?(o(),r("div",le,[d("div",oe,[d("div",ne,[e(g).data?(o(),r("h1",re,"Hello "+z(e(g).data[0].full_name)+", it is "+z(e(u)),1)):i("",!0),a.value.dayExists?i("",!0):(o(),r("h1",ie,"It's a New Day!")),a.value.dayExists&&a.value.nullLogin&&a.value.nullLogout?(o(),r("h1",de,"You're yet to sign in! ")):i("",!0),a.value.dayExists&&!a.value.nullLogin&&!a.value.nullLogout?(o(),r("h1",ue,"You're Done With work for today!")):i("",!0),a.value.dayExists&&!a.value.nullLogin&&a.value.nullLogout?(o(),r("h1",ge,"You're yet to sign out! ")):i("",!0)]),e(l).data.length!=0?(o(),r("p",ce,"Here's is your work attendance sheet")):i("",!0),e(l).data.length==0?(o(),r("p",me,"Your worklog is empty, make your first day entry below!")):i("",!0),e(t).data&&e(l).data.length!=0?(o(),O(se,{key:2,class:"py-4 px-3 my-2 border-gray-400 border-[2px] rounded",myList:e(l).data,compStudId:e(t).data},null,8,["myList","compStudId"])):i("",!0),a.value.dayExists&&a.value.nullLogin?(o(),r("div",fe,[c(e(h),{variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:$},{default:v(()=>s[1]||(s[1]=[_(" Submit Login ")])),_:1}),d("div",ye,[d("div",pe,[s[2]||(s[2]=d("p",{class:"text-center"},"Please Provide Signature",-1)),c(e(R),{ref_key:"signature",ref:n,sigOption:m.option,w:"300px",h:"200px",disabled:m.disabled,class:"border-[5px] border-[rgb(35,35,35)] rounded"},null,8,["sigOption","disabled"])])]),c(e(h),{class:"mx-2",variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:p},{default:v(()=>s[3]||(s[3]=[_("Clear Signature")])),_:1})])):i("",!0),a.value.dayExists&&!a.value.nullLogin&&a.value.nullLogout?(o(),r("div",be,[c(e(h),{variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:j},{default:v(()=>s[4]||(s[4]=[_(" Submit Logout ")])),_:1}),d("div",xe,[d("div",ve,[s[5]||(s[5]=d("p",{class:"text-center"},"Please Provide Signature",-1)),c(e(R),{ref_key:"signature",ref:n,sigOption:m.option,w:"300px",h:"200px",disabled:m.disabled,class:"border-[5px] border-[rgb(35,35,35)] rounded"},null,8,["sigOption","disabled"])]),d("div",_e,[s[6]||(s[6]=d("p",{class:"text-nowrap"},"Please add your Journal Entry",-1)),c(e(ee),{variant:"subtle",ref_for:!0,placeholder:"Journal Entry",disabled:!1,modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=x=>y.value=x),class:"w-[180px] h-[200px]"},null,8,["modelValue"])])]),d("div",null,[c(e(h),{class:"mx-2",variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:p},{default:v(()=>s[7]||(s[7]=[_("Clear Signature")])),_:1})])])):i("",!0),d("div",he,[a.value.dayExists?i("",!0):(o(),O(e(h),{key:0,class:"",variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:J},{default:v(()=>s[8]||(s[8]=[_(" New Day? ")])),_:1})),c(e(h),{class:"ml-auto",variant:"solid",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:P},{default:v(()=>s[9]||(s[9]=[_("User Logout")])),_:1})])])])):i("",!0)],64))}};export{Le as default};
