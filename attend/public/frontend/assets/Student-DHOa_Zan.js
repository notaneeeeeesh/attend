import{r as _,c as n,k as h,o,a as r,h as a,l as L,m as u,w as T,t as x,f as v,e as w,u as J,i as p,_ as k}from"./index-CcBn3r5r.js";import{_ as z}from"./Tooltip.vue_vue_type_script_setup_true_lang-BjDBb6kc.js";const I={key:0},$={__name:"DaysList",props:{compStudId:String},setup(S){const i=S,c=_(),d=_(),t=n({url:"attend.api.fetchers.get_student_days_list"});t.submit({student:i.compStudId}),h(t,()=>{t.data!=""&&t.data&&(c.value=Object.keys(JSON.parse(JSON.stringify(t.data))[0]))}),h(c,()=>{d.value=JSON.parse(JSON.stringify(c.value)).map(m=>s[m])});const s={date:{label:"Date",key:"date",width:"300px"},login_time:{label:"Login time",key:"login_time",width:"300px"},logout_time:{label:"Logout Time",key:"logout_time",width:"300px"}};return(m,l)=>(o(),r("div",null,[d.value?(o(),r("div",I,[a(t)!=""&&d.value?(o(),L(a(z),{key:0,class:"h-[150px]",columns:d.value,rows:a(t).data,"row-key":"user",options:{selectable:!1}},null,8,["columns","rows"])):u("",!0)])):u("",!0)]))}},U={class:"m-10 bg-"},V={key:0,class:"text-3xl"},j={key:1},F={key:4},H={key:5},Y={__name:"Student",setup(S){const i=new Date().toJSON().slice(0,10),c=J(),d=_(!1),t=_({dayExists:!1,nullLogin:!0,nullLogout:!0}),s=_(),m=n({url:"attend.api.roles.get_user_role",auto:!0});T(()=>{m.data==="Student"?c.push("/Student"):d.value=!0});const l=n({url:"frappe.auth.get_logged_user",auto:!0});h(l,()=>{f.reset(),f.submit({student:l.data}),g.submit({student:l.data})});const f=n({url:"attend.api.fetchers.get_student_from_id"}),g=n({url:"attend.api.fetchers.get_student_days_list"}),D=n({url:"attend.api.actions.student_create_day"}),N=n({url:"attend.api.actions.student_login"}),E=n({url:"attend.api.actions.student_logout"});h(g,()=>{if(g.data!=null)for(var b=g.data.length,e=0;e<b;e++){const y=g.data[e];if(y.date==i){t.value.dayExists=!0,y.login_time!=null&&(t.value.nullLogin=!1),y.logout_time!=null&&(t.value.nullLogout=!1),s.value=y;break}}});const B=()=>{s.value.login_time=new Date().toLocaleTimeString("en-US",{hour12:!1}),N.submit({student:l.data,date:i,time:s.value.login_time}),window.location.reload()},C=()=>{s.value.logout_time=new Date().toLocaleTimeString("en-US",{hour12:!1}),E.submit({student:l.data,date:i,time:s.value.logout_time}),window.location.reload()},R=()=>{D.submit({student:l.data,date:i}),window.location.reload(),console.log("Creating new day entry!")},O=()=>{console.log(s.value),console.log(t.value)};return(b,e)=>(o(),r("div",U,[a(f).data?(o(),r("h1",V,"Hello "+x(a(f).data[0].full_name)+", it is "+x(a(i)),1)):u("",!0),t.value.dayExists&&!t.value.nullLogin&&!t.value.nullLogout?(o(),r("h2",j,"You're Done With work for today!")):u("",!0),a(l).data?(o(),L($,{key:2,compStudId:a(l).data},null,8,["compStudId"])):u("",!0),t.value.dayExists?u("",!0):(o(),L(a(k),{key:3,variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:R},{default:v(()=>e[0]||(e[0]=[p(" New Day? ")])),_:1})),t.value.dayExists&&t.value.nullLogin&&t.value.nullLogout?(o(),r("div",F,[w(a(k),{variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:B},{default:v(()=>e[1]||(e[1]=[p(" Login ")])),_:1})])):u("",!0),t.value.dayExists&&!t.value.nullLogin&&t.value.nullLogout?(o(),r("div",H,[w(a(k),{variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:C},{default:v(()=>e[2]||(e[2]=[p(" Logout ")])),_:1})])):u("",!0),w(a(k),{variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:O},{default:v(()=>e[3]||(e[3]=[p(" Print Today ")])),_:1})]))}};export{Y as default};
