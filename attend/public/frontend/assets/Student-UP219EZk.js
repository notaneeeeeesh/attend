import{d as I,k as U,r as k,l as O,m as F,o as n,a as r,n as H,t as E,p as d,b as i,q as Y,h as e,e as f,v as q,c as b,w as A,x as W,y as V,f as h,F as G,u as K,s as M,i as _,_ as w,E as R}from"./index-9Jd1avbo.js";import{_ as Q}from"./Tooltip.vue_vue_type_script_setup_true_lang-CDkEbZi3.js";const X={class:"space-y-1.5"},Z=["for"],ee=["placeholder","disabled","id","value","rows"],te=I({__name:"Textarea",props:{size:{default:"sm"},variant:{default:"subtle"},placeholder:{},disabled:{type:Boolean},id:{},modelValue:{},debounce:{},rows:{default:3},label:{}},emits:["update:modelValue"],setup(L,{expose:m,emit:y}){const o=L,p=y,g=U(),S=k(null),D=O(()=>{let l={sm:"text-base rounded",md:"text-base rounded",lg:"text-lg rounded-md",xl:"text-xl rounded-md"}[o.size],a={sm:["py-1.5 px-2"],md:["py-1.5 px-2.5"],lg:["py-1.5 px-3"],xl:["py-1.5 px-3"]}[o.size],c=o.disabled?"disabled":o.variant,u={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",o.variant==="outline"?"border-gray-300":"border-transparent"]}[c];return[l,a,u,o.disabled?"text-gray-600":"text-gray-800","transition-colors w-full block"]}),s=O(()=>[{sm:"text-xs",md:"text-base",lg:"text-lg",xl:"text-xl"}[o.size],"text-gray-600"]);let C=l=>{p("update:modelValue",l)};o.debounce&&(C=F(C,o.debounce));let v=l=>{C(l.target.value)};return m({el:S}),(l,a)=>(n(),r("div",X,[l.label?(n(),r("label",{key:0,class:H(["block",s.value]),for:l.id},E(l.label),11,Z)):d("",!0),i("textarea",Y({ref_key:"textareaRef",ref:S,placeholder:l.placeholder,class:D.value,disabled:l.disabled,id:l.id,value:l.modelValue,rows:l.rows,onInput:a[0]||(a[0]=(...c)=>e(v)&&e(v)(...c)),onChange:a[1]||(a[1]=(...c)=>e(v)&&e(v)(...c))},e(g)),null,16,ee)]))}}),se={key:0},ae={__name:"DaysList",props:["compStudId","myList"],setup(L){const m=L,y={date:{label:"Date",key:"date"},login_time:{label:"Login time",key:"login_time"},logout_time:{label:"Logout Time",key:"logout_time"}},o=Object.keys(JSON.parse(JSON.stringify(m.myList))[0]),p=JSON.parse(JSON.stringify(o)).map(g=>y[g]);return(g,S)=>(n(),r("div",null,[e(p)?(n(),r("div",se,[f(e(Q),{class:"h-[200px]",columns:e(p),rows:L.myList,"row-key":"user",options:{selectable:!1,showTooltip:!1}},null,8,["columns","rows"])])):d("",!0)]))}},le={key:0,class:"text-3xl"},oe={key:1,class:"flex justify-center"},ne={class:"m-10 min-w-fit max-w-4xl w-3/4 h-3/4 min-h-fit"},ie={class:"min-w-fit min-h-fit"},re={key:0,class:"text-3xl"},ue={key:1,class:"text-2xl"},de={key:2,class:"text-2xl"},ge={key:3,class:"text-2xl"},ce={key:4,class:"text-2xl"},fe={key:1,class:"min-w-fit min-h-fit"},me={class:"p-2 flex flex-row justify-evenly min-w-fit min-h-fit"},ye={class:"flex flex-col"},pe={key:2,class:"min-w-fit min-h-fit"},be={class:"p-2 flex flex-row justify-evenly min-w-fit min-h-fit"},ve={class:"flex flex-col"},xe={class:"flex flex-col items-center min-w-fit min-h-fit"},he={class:"flex"},ke={__name:"Student",setup(L){const m=q({count:0,option:{penColor:"rgb(170, 170, 170)",backgroundColor:"rgb(35,35,35)"},disabled:!1}),y=k(""),o=k(null),p=()=>{o.value.clear()},g=new Date().toJSON().slice(0,10),S=K(),D=k(!1),s=k({dayExists:!1,nullLogin:!0,nullLogout:!0});console.log(new Date().toJSON());const v=k(),l=b({url:"attend.api.roles.get_user_role",auto:!0});A(()=>{l.data==="Student"?S.push("/Student"):D.value=!0});const a=b({url:"frappe.auth.get_logged_user",auto:!0});a.promise.then(()=>{c.submit({student:a.data}),u.submit({student:a.data})});const c=b({url:"attend.api.fetchers.get_student_from_id"}),u=b({url:"attend.api.fetchers.get_student_days_list"}),J=b({url:"attend.api.actions.student_create_day"}),N=b({url:"attend.api.actions.student_login"}),z=b({url:"attend.api.actions.student_logout"});W(u,()=>{if(console.log("watching daysList"),u.data!=null)for(var B=u.data.length,t=0;t<B;t++){const x=u.data[t];if(x.date==g){s.value.dayExists=!0,x.login_time!==null&&(console.log("reached login block"),s.value.nullLogin=!1),x.logout_time!==null&&(console.log("reached logout block"),s.value.nullLogout=!1),v.value=x;break}}});const $=()=>{N.submit({student:a.data,date:g,time:new Date().toLocaleTimeString("en-US",{hour12:!1}),signature:o.value.save()}),N.promise.then(()=>{u.submit({student:a.data})})},j=()=>{z.submit({student:a.data,date:g,time:new Date().toLocaleTimeString("en-US",{hour12:!1}),signature:o.value.save(),journal_entry:y.value}),z.promise.then(()=>{u.submit({student:a.data})})},P=()=>{J.submit({student:a.data,date:g}),window.location.reload(),console.log("Creating new day entry!")},T=()=>{M.logout.submit(),window.location.reload()};return(B,t)=>(n(),r(G,null,[e(l).loading||e(a).loading||e(u).loading?(n(),r("h1",le,"Hang on a moment...")):d("",!0),!e(l).loading&&!e(a).loading&&!e(u).loading?(n(),r("div",oe,[i("div",ne,[i("div",ie,[e(c).data?(n(),r("h1",re,"Hello "+E(e(c).data[0].full_name)+", it is "+E(e(g)),1)):d("",!0),s.value.dayExists?d("",!0):(n(),r("h1",ue,"It's a New Day!")),s.value.dayExists&&s.value.nullLogin&&s.value.nullLogout?(n(),r("h1",de,"You're yet to sign in! ")):d("",!0),s.value.dayExists&&!s.value.nullLogin&&!s.value.nullLogout?(n(),r("h1",ge,"You're Done With work for today!")):d("",!0),s.value.dayExists&&!s.value.nullLogin&&s.value.nullLogout?(n(),r("h1",ce,"You're yet to sign out! ")):d("",!0)]),t[10]||(t[10]=i("p",{class:"text-xl"},"Here's is your work attendance sheet",-1)),e(a).data&&e(u).data?(n(),V(ae,{key:0,class:"py-4 px-3 my-2 border-gray-400 border-[2px] rounded",myList:e(u).data,compStudId:e(a).data},null,8,["myList","compStudId"])):d("",!0),s.value.dayExists&&s.value.nullLogin?(n(),r("div",fe,[f(e(w),{variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:$},{default:h(()=>t[1]||(t[1]=[_(" Submit Login ")])),_:1}),i("div",me,[i("div",ye,[t[2]||(t[2]=i("p",{class:"text-center"},"Please Provide Signature",-1)),f(e(R),{ref_key:"signature",ref:o,sigOption:m.option,w:"300px",h:"200px",disabled:m.disabled,class:"border-[5px] border-[rgb(35,35,35)] rounded"},null,8,["sigOption","disabled"])])]),f(e(w),{variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:p},{default:h(()=>t[3]||(t[3]=[_("Clear Signature")])),_:1})])):d("",!0),s.value.dayExists&&!s.value.nullLogin&&s.value.nullLogout?(n(),r("div",pe,[f(e(w),{variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:j},{default:h(()=>t[4]||(t[4]=[_(" Submit Logout ")])),_:1}),i("div",be,[i("div",ve,[t[5]||(t[5]=i("p",{class:"text-center"},"Please Provide Signature",-1)),f(e(R),{ref_key:"signature",ref:o,sigOption:m.option,w:"300px",h:"200px",disabled:m.disabled,class:"border-[5px] border-[rgb(35,35,35)] rounded"},null,8,["sigOption","disabled"])]),i("div",xe,[t[6]||(t[6]=i("p",{class:"text-nowrap"},"Please add your Journal Entry",-1)),f(e(te),{variant:"subtle",ref_for:!0,placeholder:"Journal Entry",disabled:!1,modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=x=>y.value=x),class:"w-[180px] h-[200px]"},null,8,["modelValue"])])]),i("div",null,[f(e(w),{variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:p},{default:h(()=>t[7]||(t[7]=[_("Clear Signature")])),_:1})])])):d("",!0),i("div",he,[s.value.dayExists?d("",!0):(n(),V(e(w),{key:0,class:"",variant:"outline",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:P},{default:h(()=>t[8]||(t[8]=[_(" New Day? ")])),_:1})),f(e(w),{class:"ml-auto",variant:"solid",theme:"gray",size:"lg",label:"Button",loading:!1,onClick:T},{default:h(()=>t[9]||(t[9]=[_("User Logout")])),_:1})])])])):d("",!0)],64))}};export{ke as default};
